**CDR** 

_(при условии, что длина звонка ограничена одним часом)_

    CDR1.
    Smoke
    Определить тип вызова
    Предусловие: запустить CDR-генератор.
    Шаги:
    I. Проверить тип звонка.
    Ожидаемый результат: значение равно "01" или "02".

    CDR2.
    Smoke
    Определить номер абонента
    Предусловие: запустить CDR-генератор.
    Шаги:
    I. Проверить номер абонента.
    Ожидаемый результат: полный номер состоит ровно из 11 цифр.

    CDR2.1
    Sanity
    Определить детализированный номер абонента 
    Предусловие: запустить CDR-генератор.
    I. Проверить номер абонента.
    Ожидаемый результат: номер начинается с 7, 
                         код оператора начинается с 9,
                         полный номер состоит ровно из 11 цифр.
    
    CDR3.
    Smoke
    Определить дату и время начала звонка
    Предусловие: запустить CDR-генератор.
    Шаги:
    I. Проверить дату и время начала звонка.
    Ожидаемый результат: год начала звонка не превышает текущий год,
                         месяц начала звонка не превышает текущий месяц,
                         день начала звонка не превышает текущий день,
                         час начала звонка не превышает текущий час,
                         минута начала звонка не превышает текущую минуту,
                         секунда начала звонка не превышает текущую секунду.
                         
    CDR4.
    Smoke
    Определить дату и время окончания звонка
    Предусловие: запустить CDR-генератор.
    Шаги:
    I. Проверить дату и время окончания звонка.
    Ожидаемый результат: год окончания звонка следующий или совпадает с годом начала звонка,
                         месяц окончания звонка следующий или совпадает с месяцем начала звонка,
                         день окончания звонка следующий или совпадает с днём начала звонка,
                         час окончания звонка следующий или совпадает с часом начала звонка,
                         минута окончания звонка не превышает ту же минуту следующего часа от начала звонка,
                         секунда окончания звонка не превышает ту же секунду той же минуты следующего часа от начала звонка.    

    CDR5.
    Smoke
    Верифицировать запись CDR в хранилище
    Предусловие: запустить CDR-генератор.
    Шаги:
    I. Проверить, появилась ли запись нового CDR в хранилище.
    Ожидаемый результат: запись нового CDR успешно помещена в хранилище без искажений.

**BRT**

    BRT1.
    Smoke
    Верифицировать чтение CDR из хранилища
    Предусловие: запустить BRT.
    Шаги:
    I. Проверить, была ли получена на вход запись из хранилища CDR.
    Ожидаемый результат: запись CDR успешно получена.

    BRT2.
    Smoke
    Верифицировать соединение BRT с базой клиентов
    Предусловие: запустить BRT.
    Шаги:
    I. Проверить, удалось ли подключиться к базе
    Ожидаемый результат: соединение с базой успешно установлено.

    BRT3.
    Smoke 
    Верифицировать результат запроса BRT к базе клиентов
    Предусловие: запустить BRT, соединиться с базой клиентов, прочитать CDR.
    Шаги:
    I. Проверить результат запроса BRT к базе.
    Ожидаемый результат: клиент верно определён по номеру телефона из CDR,
                         баланс клиента больше 0

    BRT4.
    Smoke
    Верифицировать генерацию CDR+
    Предусловие: запустить BRT, получить информацию об абоненте.
    Шаги:
    I. Проверить корректность сгенерированного CDR+.
    Ожидаемый результат: первые позиции CDR+ совпадают с полученым ранее CDR,
                         код тарифа абонента определён верно.

    BRT5.
    Smoke
    Верифицировать запись CDR+ в хранилище
    Предусловие: запустить BRT, сгенерировать CDR+.
    Шаги:
    I. Проверить, появилась ли запись нового CDR+ в хранилище.
    Ожидаемый результат: запись нового CDR+ успешно помещена в хранилище без искажений.

    BRT6.
    Smoke
    Верифицировать чтение отчёта HRS из хранилища
    Предусловие: запустить BRT.
    Шаги:
    I. Проверить, была ли получена на вход запись из хранилища отчётов HRS.
    Ожидаемый результат: отчёт HRS успешно получен.

    BRT7.
    Smoke
    Верифицировать результат изменения баланса абонента
    Предусловие: запустить BRT, прочитать отчёт HRS, соединиться с базой клиентов.
    Шаги:
    I. Проверить, изменился ли баланс абонента в базе клиентов.
    Ожидаемый результат: баланс успешно изменился,
                         баланс равен предыдущему значению после вычета стоимости звонка из отчёта HRS.

**HRS**

    HRS1.
    Smoke
    Верифицировать чтение CDR+ из хранилища
    Предусловие: запустить HRS.
    Шаги:
    I. Проверить, была ли получена на вход запись из хранилища CDR+.
    Ожидаемый результат: запись CDR+ успешно получена.

    HRS2.
    Smoke
    Верифицировать рассчёт длительности звонка
    Предусловие: запустить HRS, прочитать CDR+.
    Шаги:
    I. Проверить корректность рассчёта длительности разговора абонента.
    Ожидаемый результат: длительность разговора равна {окончание звонка} - {начало звонка}.

    HRS3.
    Smoke
    Верифицировать рассчёт стоимости звонка для тарифа "Безлимит 300"
    Предусловие: запустить HRS, рассчитать длительность звонка.
    Шаги:
    I. Проверить корректность рассчёта стоимости звонка.
    Ожидаемый результат: если на счету абонента есть тарифные минуты, списать столько же минут со счёта,
                         если у абонента кончились тарифные минуты, 1 минута = 1 рубль.

    HRS4.
    Smoke
    Верифицировать рассчёт стоимости звонка для тарифа "Поминутный"
    Предусловие: запустить HRS, рассчитать длительность звонка.
    Шаги:
    I. Проверить корректность рассчёта стоимости звонка.
    Ожидаемый результат: 1 минута = 1.5 рубля.

    HRS5.
    Smoke
    Верифицировать рассчёт стоимости звонка для тарифа "Обычный"
    Предусловие: запустить HRS, рассчитать длительность звонка.
    Шаги:
    I. Проверить корректность рассчёта стоимости звонка.
    Ожидаемый результат: если звонок входящий, то он бесплатный,
                         если звонок исходящий и на счету абонента есть тарифные минуты, то 1 минута = 0.5 рублей,
                         если звонок исходящий и на счету абонента нет тарифных минут, то 1 минута = 1.5 рубля.
    
    HRS6.
    Smoke
    Верифицировать запись отчёта HRS в хранилище
    Предусловие: запустить HRS, сгенерировать отчёт.
    Шаги:
    I. Проверить, появилась ли запись отчёта HRS в хранилище.
    Ожидаемый результат: запись отчёта HRS успешно помещена в хранилище без искажений.

**CRM**

    CRM1.
    Smoke
    Проверить пополнение счёта от лица абонента
    Предусловие: запустить CRM.
    Шаги:
    I. Заполнить поля.
    II. Отправить запрос.
    Ожидаемый результат: Response 200,
                         счёт абонента повысился.

    CRM2.
    Smoke
    Проверить детализацию звонков от лица абонента
    Предусловие: запустить CRM.
    Шаги:
    I. Заполнить поля.
    II. Отправить запрос.
    Ожидаемый результат: Response 200,
                         детализация звонков получена.
    
    CRM3.
    Smoke
    Проверить смену тарифа от лица менеджера
    Предусловие: запустить CRM.
    Шаги:
    I. Заполнить поля.
    II. Отправить запрос.
    Ожидаемый результат: Response 200,
                         тариф успешно изменён.

    CRM4.
    Smoke
    Проверить создание нового пользователя от лица менеджера
    Предусловие: запустить CRM.
    Шаги:
    I. Заполнить поля.
    II. Отправить запрос.
    Ожидаемый результат: Response 200,
                         новый пользователь успешно создан.
    
    CRM5.
    Smoke
    Проверить выполнение тарификации от лица менеджера
    Предусловие: запустить CRM.
    Шаги:
    I. Заполнить поля.
    II. Отправить запрос.
    Ожидаемый результат: Response 200,
                         тарификация успешно применена.